改自一位大佬的代码，主要是为了方便自己使用